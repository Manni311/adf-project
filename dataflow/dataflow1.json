{
	"name": "dataflow1",
	"properties": {
		"type": "MappingDataFlow",
		"typeProperties": {
			"sources": [
				{
					"dataset": {
						"referenceName": "Excel2",
						"type": "DatasetReference"
					},
					"name": "source1"
				},
				{
					"dataset": {
						"referenceName": "typeexcel",
						"type": "DatasetReference"
					},
					"name": "source2"
				}
			],
			"sinks": [],
			"transformations": [
				{
					"name": "derivedColumn1"
				},
				{
					"name": "join1",
					"description": "joining to source 2"
				},
				{
					"name": "skdate"
				}
			],
			"scriptLines": [
				"source(output(",
				"          InvoiceNumber as string,",
				"          Date as string,",
				"          Type as string,",
				"          Period as string,",
				"          DueDate as string,",
				"          InvoiceDate as string,",
				"          FromDate as string,",
				"          ToDate as string,",
				"          NetAmount as string,",
				"          VatAmount as string,",
				"          grossValue as string",
				"     ),",
				"     allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     ignoreNoFilesFound: false) ~> source1",
				"source(output(",
				"          SKTransType as string,",
				"          BKTransType as string,",
				"          TransDesc as string",
				"     ),",
				"     allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     ignoreNoFilesFound: false) ~> source2",
				"skdate derive(Date = toString(toDate(Date, 'yyyy-MM-dd'), 'dd-MM-yyyy')) ~> derivedColumn1",
				"source1, source2 join(Type == BKTransType,",
				"     joinType:'inner',",
				"     matchType:'exact',",
				"     ignoreSpaces: false,",
				"     broadcast: 'auto')~> join1",
				"join1 derive(skdate = toString(Date, 'ddMMyyyy'),",
				"          {Charecontrol number} = concat(Type+'-'+InvoiceNumber),",
				"          {Filename          } = concat('sales', toString(currentDate(), 'ddMMyyyy'), '.xlsx'),",
				"          {AsOfDate   } = toString(\r",
				"    addDays(\r",
				"       toDate(\r",
				"          concat(\r",
				"             substring(toString(addMonths(toDate(Date, 'yy-MM-dd'), 1), 'yyyy-MM-dd'), 0, 7),\r",
				"             '-01'\r",
				"          ), 'yyyy-MM-dd'\r",
				"       ),\r",
				"       -1\r",
				"    ),\r",
				"    'dd-MM-yyyy'\r",
				")\r",
				") ~> skdate"
			]
		}
	}
}